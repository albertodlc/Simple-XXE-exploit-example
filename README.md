# Simple-XXE-exploit-example

<p align="center">
    <img height="auto" width="auto" src="img/xxe-injection.svg" />
</p>

## Background

I have developed a simple example of an XXE attack using PHP (backend) and a web for testing (frontend).

## Contents

- [What is a XXE attack ?](#what-is-a-xxe-attack-?)
- [Deployment](#deployment)
- [References](#references)

## What is a XXE attack ?

"XML external entity injection (also known as XXE) is a web security vulnerability that allows an attacker to interfere with an application's processing of XML data. It often allows an attacker to view files on the application server filesystem, and to interact with any back-end or external systems that the application itself can access.

In some situations, an attacker can escalate an XXE attack to compromise the underlying server or other back-end infrastructure, by leveraging the XXE vulnerability to perform server-side request forgery (SSRF) attacks." [[1]](#1).

## Deployment

Install Apache

```sh
sudo apt update
sudo apt install apache2
```

Type `http://localhost` on your browser and a welcome webiste should display.

Now install the Apache mods necessary for PHP correct operation.

```sh
sudo apt install php
sudo apt install libapache2-mod-php
sudo apt install libapache2-mod-php7.4 
sudo apt install php-xml

sudo a2dismod mpm_event
sudo a2enmod mpm_prefork
sudo a2enmod php7.4

sudo service apache2 restart
```


Now you need to modify the configuration file for the Apache server, `sudo nano /etc/apache2/apache2.conf`, append the following snippet just after the first piece of code:

```sh
<FilesMatch "^\.ht">
        Require all denied
</FilesMatch>

<FilesMatch "\.php$">
SetHandler application/x-httpd-php
</FilesMatch>
```

Reload the service:

```sh
sudo service apache2 restart
```

And test that all is working fine, create a new file, `test.php` 

```php
<?php

// Show all information, defaults to INFO_ALL
phpinfo();

?>
```

And copy&paste it to the next path

```sh
sudo cp /home/YOUR_PATH_TO_FILE /var/www/html/
```

Then browse to `http://localhost/test.php`

<p align="center">
    <img height="auto" width="auto" src="img/test.png" />
</p>

And finally copy&paste the script with the xxe vulnerability to the html path of the server `/var/www/html`.

Then you can use the website, uploading different xml files and requesting different paths.

## References
<a id="1">[1]</a> 
https://portswigger.net/web-security/xxe